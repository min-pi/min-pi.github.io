<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo world" />










<meta name="description" content="概述：本文基于微软官方教程 编写 Hello World Windows 驱动程序 (KMDF) ，结合笔者在配置开发环境过程中踩的坑，详细讲解了如何使用 USB 连接主计算机和目标计算机，并配置相应的双机开发环境。最后，通过在 Hello World 程序入口添加断点来验证环境正确性。（ps：主计算机用于开发和调试，目标计算机用于运行编写的驱动程序） 核心步骤： 在主计算机上安装 visual">
<meta property="og:type" content="article">
<meta property="og:title" content="windows 驱动程序开发环境配置（USB连接的双机开发）">
<meta property="og:url" content="http://example.com/2024/03/06/configure-windows-driver-development-environment/index.html">
<meta property="og:site_name" content="PIPI&#39;s blog">
<meta property="og:description" content="概述：本文基于微软官方教程 编写 Hello World Windows 驱动程序 (KMDF) ，结合笔者在配置开发环境过程中踩的坑，详细讲解了如何使用 USB 连接主计算机和目标计算机，并配置相应的双机开发环境。最后，通过在 Hello World 程序入口添加断点来验证环境正确性。（ps：主计算机用于开发和调试，目标计算机用于运行编写的驱动程序） 核心步骤： 在主计算机上安装 visual">
<meta property="og:locale">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240306174436450.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240306174601687.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240306180000794.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240306180500822.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240306181215750.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240306181337978.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/pic1.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/pic2.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/pic3.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307112315521.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307112403820.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307120009804.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307120111745.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307120812626.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307162231068.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307162605583.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307172708095.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307172822833.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307172957286.png">
<meta property="og:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240307162522591.png">
<meta property="article:published_time" content="2024-03-06T07:52:10.581Z">
<meta property="article:modified_time" content="2024-03-07T09:59:07.528Z">
<meta property="article:author" content="PIPI">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/configure-windows-driver-development-environment/image-20240306174436450.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'pipi'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/2024/03/06/configure-windows-driver-development-environment/"/>





  <title>windows 驱动程序开发环境配置（USB连接的双机开发） | PIPI's blog</title>
  








<meta name="generator" content="Hexo 7.1.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">PIPI's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/03/06/configure-windows-driver-development-environment/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="PIPI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PIPI's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">windows 驱动程序开发环境配置（USB连接的双机开发）</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2024-03-06T15:52:10+08:00">
                2024-03-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-eye"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="概述："><a href="#概述：" class="headerlink" title="概述："></a>概述：</h3><p>本文基于微软官方教程 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/gettingstarted/writing-a-very-small-kmdf--driver">编写 Hello World Windows 驱动程序 (KMDF)</a> ，结合笔者在配置开发环境过程中踩的坑，详细讲解了如何使用 USB 连接主计算机和目标计算机，并配置相应的双机开发环境。最后，通过在 Hello World 程序入口添加断点来验证环境正确性。（ps：主计算机用于开发和调试，目标计算机用于运行编写的驱动程序）</p>
<h3 id="核心步骤："><a href="#核心步骤：" class="headerlink" title="核心步骤："></a>核心步骤：</h3><ul>
<li>在主计算机上安装 visual studio 2022 + Windows 驱动程序工具包</li>
<li>编写 Hello World 驱动程序</li>
<li>生成 Hello World 驱动程序</li>
<li>本地测试 Hello World 驱动程序 （可选）</li>
<li>预配目标计算机</li>
<li>在目标计算机上部署解决方案</li>
<li>在目标计算机上安装驱动程序</li>
<li>使用 WinDBG + USB 的模式调试目标计算机</li>
</ul>
<h3 id="Step1：在主计算机上安装-visual-studio-2022-Windows-驱动程序工具包"><a href="#Step1：在主计算机上安装-visual-studio-2022-Windows-驱动程序工具包" class="headerlink" title="Step1：在主计算机上安装 visual studio 2022 + Windows 驱动程序工具包"></a>Step1：在主计算机上安装 visual studio 2022 + Windows 驱动程序工具包</h3><ul>
<li>visual studio官方网址如下：<a target="_blank" rel="noopener" href="https://visualstudio.microsoft.com/zh-hans/">https://visualstudio.microsoft.com/zh-hans/</a></li>
<li>个人学习使用的话，下载社区版本即可</li>
<li>安装时 <strong>工作负载</strong> 选择 <strong>使用 C++ 的桌面开发</strong></li>
<li>安装时 <strong>单个组件</strong> 添加：<ul>
<li>MSVC v143 - VS 2022 C++ ARM64&#x2F;ARM64EC Spectre 缓解库（最新版本）</li>
<li>MSVC v143 - VS 2022 C++ x64&#x2F;x86 Spectre 缓解库（最新版本）</li>
<li>带有 Spectre 缓解库的适用于最新 v143 生成工具的 C++ ATL (ARM64&#x2F;ARM64EC)</li>
<li>适用于具有 Spectre 缓解功能的最新 v143 生成工具的 C++ ATL (x86 &amp; x64)</li>
<li>带有 Spectre 缓解库的适用于最新 v143 生成工具的 C++ MFC (ARM64&#x2F;ARM64EC)</li>
<li>适用于具有 Spectre 缓解措施的最新 v143 生成工具的 C++ MFC (x86 &amp; x64)</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://go.microsoft.com/fwlink/?linkid=2249371">WDK下载链接</a>，按照默认参数直接安装，一路 Next 即可</li>
</ul>
<h3 id="Step2：编写-Hello-World-驱动程序"><a href="#Step2：编写-Hello-World-驱动程序" class="headerlink" title="Step2：编写 Hello World 驱动程序"></a>Step2：编写 Hello World 驱动程序</h3><ol>
<li>打开 Microsoft Visual Studio。 在“文件” 菜单上，选择“新建”&gt;“项目” 。</li>
<li>在“新建项目”对话框的左侧下拉列表中，选择“C++”，在中间下拉列表中，选择“Windows”，然后在右侧下拉列表中，选择“驱动程序” 。</li>
<li>从项目类型列表中选择“内核模式驱动程序，空(KMDF)”。 选择“<strong>下一页</strong>”。</li>
<li>在“配置新项目”对话框中，在“项目名称”字段中输入“KmdfHelloWorld” 。</li>
<li>在“位置”字段中，输入要在其中创建新项目的目录。</li>
<li>选中“将解决方案和项目置于同一目录中”，然后选择“创建” 。</li>
<li>在“添加新项目”对话框中，选择“C++ 文件”。 对于“名称”，请输入“Driver.c”。<ul>
<li><strong>注意：名称以 .c 结尾！编写的是 c 文件！</strong></li>
</ul>
</li>
<li>将下列代码粘贴到 “Driver.c” 文件中。这是一份非常简单的 windows 驱动代码，在<strong>初始化</strong>和<strong>绑定设备</strong>时会打印相应的提示信息，详细的讲解请参考官方文档。</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ntddk.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;wdf.h&gt;</span></span></span><br><span class="line">DRIVER_INITIALIZE DriverEntry;</span><br><span class="line">EVT_WDF_DRIVER_DEVICE_ADD KmdfHelloWorldEvtDeviceAdd;</span><br><span class="line"></span><br><span class="line">NTSTATUS </span><br><span class="line"><span class="title function_">DriverEntry</span><span class="params">(</span></span><br><span class="line"><span class="params">    _In_ PDRIVER_OBJECT     DriverObject, </span></span><br><span class="line"><span class="params">    _In_ PUNICODE_STRING    RegistryPath</span></span><br><span class="line"><span class="params">)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// NTSTATUS variable to record success or failure</span></span><br><span class="line">    NTSTATUS status = STATUS_SUCCESS;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Allocate the driver configuration object</span></span><br><span class="line">    WDF_DRIVER_CONFIG config;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Print &quot;Hello World&quot; for DriverEntry</span></span><br><span class="line">    KdPrintEx(( DPFLTR_IHVDRIVER_ID, DPFLTR_INFO_LEVEL, <span class="string">&quot;KmdfHelloWorld: DriverEntry\n&quot;</span> ));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Initialize the driver configuration object to register the</span></span><br><span class="line">    <span class="comment">// entry point for the EvtDeviceAdd callback, KmdfHelloWorldEvtDeviceAdd</span></span><br><span class="line">    WDF_DRIVER_CONFIG_INIT(&amp;config, </span><br><span class="line">                           KmdfHelloWorldEvtDeviceAdd</span><br><span class="line">                           );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Finally, create the driver object</span></span><br><span class="line">    status = WdfDriverCreate(DriverObject, </span><br><span class="line">                             RegistryPath, </span><br><span class="line">                             WDF_NO_OBJECT_ATTRIBUTES, </span><br><span class="line">                             &amp;config, </span><br><span class="line">                             WDF_NO_HANDLE</span><br><span class="line">                             );</span><br><span class="line">    <span class="keyword">return</span> status;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">NTSTATUS </span><br><span class="line"><span class="title function_">KmdfHelloWorldEvtDeviceAdd</span><span class="params">(</span></span><br><span class="line"><span class="params">    _In_    WDFDRIVER       Driver, </span></span><br><span class="line"><span class="params">    _Inout_ PWDFDEVICE_INIT DeviceInit</span></span><br><span class="line"><span class="params">)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// We&#x27;re not using the driver object,</span></span><br><span class="line">    <span class="comment">// so we need to mark it as unreferenced</span></span><br><span class="line">    UNREFERENCED_PARAMETER(Driver);</span><br><span class="line"></span><br><span class="line">    NTSTATUS status;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Allocate the device object</span></span><br><span class="line">    WDFDEVICE hDevice;    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// Print &quot;Hello World&quot;</span></span><br><span class="line">    KdPrintEx(( DPFLTR_IHVDRIVER_ID, DPFLTR_INFO_LEVEL, <span class="string">&quot;KmdfHelloWorld: KmdfHelloWorldEvtDeviceAdd\n&quot;</span> ));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create the device object</span></span><br><span class="line">    status = WdfDeviceCreate(&amp;DeviceInit, </span><br><span class="line">                             WDF_NO_OBJECT_ATTRIBUTES,</span><br><span class="line">                             &amp;hDevice</span><br><span class="line">                             );</span><br><span class="line">    <span class="keyword">return</span> status;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Step3：生成-Hello-World-驱动程序"><a href="#Step3：生成-Hello-World-驱动程序" class="headerlink" title="Step3：生成 Hello World 驱动程序"></a>Step3：生成 Hello World 驱动程序</h3><ol>
<li>在<strong>“解决方案资源管理器</strong>”窗口中，选择并按住 (或右键单击) <strong>解决方案“KmdfHelloWorld” (1 个项目)</strong> ，然后选择<strong>“Configuration Manager</strong>”。 为驱动程序项目选择配置和平台。 在本练习中，我们选择“调试”和“x64”。</li>
<li>在<strong>“解决方案资源管理器</strong>”窗口中，选择并按住 (或右键单击“) <strong>KmdfHelloWorld</strong>”，然后选择<strong>“属性”。</strong> 在“Wpp 跟踪”&gt;“所有选项”中，将“运行 Wpp 跟踪”设置为“否”。 依次选择“应用”、“确定” 。</li>
<li>从<strong>“生成”</strong>菜单中选择<strong>“生成解决方案”</strong>。 Visual Studio 在“输出”窗口中显示生成进度。</li>
<li>若要查看生成的驱动程序，请在 文件资源管理器 中转到 <strong>KmdfHelloWorld</strong> 文件夹，然后转到 <strong>x64\Debug\KmdfHelloWorld</strong>。 该文件夹包括：<ul>
<li>KmdfHelloWorld.sys - 内核模式驱动程序文件</li>
<li>KmdfHelloWorld.inf - 在安装驱动程序时 Windows 使用的信息文件</li>
<li>KmdfHelloWorld.cat - 安装程序验证驱动程序的测试签名所使用的目录文件</li>
</ul>
</li>
</ol>
<h3 id="Step4：本地测试-Hello-World-驱动程序-（可选）"><a href="#Step4：本地测试-Hello-World-驱动程序-（可选）" class="headerlink" title="Step4：本地测试 Hello World 驱动程序 （可选）"></a>Step4：本地测试 Hello World 驱动程序 （可选）</h3><ol>
<li><p>Windows 系统要求安装的驱动程序必须有微软的数字签名，但很显然我们在开发过程中写的驱动不会有签名。因此，为了在本地测试，我们需要先关闭  Windows 系统的<strong>强制签名检查</strong></p>
<ul>
<li>在<strong>开始</strong>菜单，按住<strong>shift</strong>，鼠标左键单击<strong>重新启动</strong>。该操作会打开 Windows 高级启动菜单</li>
<li>依次选择：<strong>疑难解答-&gt;高级选项-&gt;启动设置-&gt;按数字键7</strong>，<strong>选择禁用驱动程序强制签名</strong></li>
</ul>
</li>
<li><p>以管理员身份运行cmd，执行如下命令，创建一个服务（driverpath需要替换成上面工程生成的.sys文件路径）</p>
<ul>
<li><code>sc create MyFirstDriver binPath= &quot;driverpath&quot; type= kernel</code></li>
</ul>
</li>
<li><p>以管理员身份运行<code>DebugView.exe</code>，在菜单栏中勾选<code>Capture Kernel</code> 和<code>Enable Verbose Kernel Output</code></p>
<ul>
<li>Debugview 是<strong>一个应用程序，支持你监视本地系统上或可通过TCP&#x2F;IP 访问的网络上任何计算机上的调试输出</strong>。</li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sysinternals/downloads/debugview">DebugView下载链接</a></li>
</ul>
</li>
<li><p>在控制台输入如下命令，启动我们之前创建好的服务，可以在DebugView中看到DriverEntry函数输出的内容</p>
<ul>
<li><code>sc start MyFirstDriver</code></li>
</ul>
</li>
<li><p>测试完毕，使用如下命令关闭服务（卸载驱动）</p>
<ul>
<li><code>sc stop MyFirstDriver</code></li>
</ul>
</li>
</ol>
<h3 id="Step5：预配目标计算机"><a href="#Step5：预配目标计算机" class="headerlink" title="Step5：预配目标计算机"></a>Step5：预配目标计算机</h3><p>因为后续我们需要在主计算机端将生成的驱动文件(包)通过网络发送到目标计算机，并进行远程部署。所以我们需要预先对主计算机和目标计算机进行配置，下载一些工具包，并保证两者间网络连接畅通（能够互相ping通）。具体配置流程分主计算机侧和目标计算机侧两部分，我们先学习目标计算机侧的配置：</p>
<p><strong>目标计算机侧操作</strong></p>
<ol>
<li><strong>下载安装 WDK</strong>。<a target="_blank" rel="noopener" href="https://go.microsoft.com/fwlink/?linkid=2249371">WDK下载链接</a>，按照默认参数直接安装，一路 Next 即可。</li>
<li>在 BIOS 中关闭 <strong>安全启动</strong>（如何进入 bios 请结合主板品牌 google 之）</li>
<li><strong>运行</strong>与目标计算机平台匹配的 <strong>WDK 测试目标设置 MSI</strong>。可以在 Remote 下的 Windows 驱动程序工具包 (WDK) 安装目录中找到该 MSI。<ul>
<li>默认路径：<code>C:\Program Files (x86)\Windows Kits\10\Remote\x64\WDK Test Target Setup x64-x64_en-us.msi</code></li>
</ul>
</li>
<li><strong>ping 通主计算机</strong><ul>
<li>开启防火墙命令：<code>NetSh Advfirewall set allprofiles state on</code></li>
<li>关闭防火墙命令：<code>NetSh Advfirewall set allprofiles state off</code></li>
</ul>
</li>
</ol>
<p><strong>主计算机侧操作</strong></p>
<ol>
<li><strong>ping 通目标计算机</strong></li>
<li>在主机计算机上的 Visual Studio 中，选择<strong>“扩展”</strong>菜单，依次指向<strong>“驱动程序”</strong>和<strong>“测试”</strong>，然后选择<strong>“配置设备”</strong> 。</li>
<li>在<strong>“配置设备”</strong>对话框中，选择<strong>“添加新设备”</strong> 。</li>
<li><strong>设备名称</strong>根据个人喜好任取。对于<strong>网络主机名</strong>，输入目标计算机的名称或本地 IP 地址。 选择<strong>“预配设备并选择调试程序设置”</strong>。</li>
</ol>
<img src="/images/configure-windows-driver-development-environment/image-20240306174436450.png" alt="image-20240306174436450" style="zoom:50%;" />

<ol start="4">
<li><p>点击 <strong>下一步</strong>，跳转至如下界面，此时需要注意以下几点：</p>
<ul>
<li><strong>Port Number</strong> 和 <strong>Key</strong> 后续可能会用到（如果使用 WinDBG + 以太网 调试的话），建议保存下来。</li>
<li>如果主计算机有多个 IP 地址，要在 <strong>Host IP</strong> 下拉框中选择能 ping 通的！</li>
</ul>
<img src="/images/configure-windows-driver-development-environment/image-20240306174601687.png" alt="image-20240306174601687" style="zoom: 50%;" />
</li>
<li><p>点击 <strong>下一步</strong>，正式开始配置目标计算机，此过程大概持续2-3分钟。预配成功的话，结果如下图所示。</p>
<img src="/images/configure-windows-driver-development-environment/image-20240306180000794.png" alt="image-20240306180000794" style="zoom:50%;" />

<ul>
<li><p>笔者此前配置时，出现过<code>Failed installing components</code>的错误，但经过尝试，它并不影响后续的操作。</p>
</li>
<li><p>建议大家先点击<strong>完成</strong>，回到<strong>Configure Devices</strong>界面，看看<strong>Driver test configuration</strong>的状态，如果为<strong>Configured for driver testing</strong>则可以进行后续操作。</p>
<img src="/images/configure-windows-driver-development-environment/image-20240306180500822.png" alt="image-20240306180500822" style="zoom:50%;" /></li>
</ul>
</li>
</ol>
<h3 id="Step6：在目标计算机上部署解决方案"><a href="#Step6：在目标计算机上部署解决方案" class="headerlink" title="Step6：在目标计算机上部署解决方案"></a>Step6：在目标计算机上部署解决方案</h3><ol>
<li><p>在<strong>“解决方案资源管理器”</strong>窗口中，选择并按住（或右键单击）KmdfHelloWorld 项目，然后选择<strong>“属性”</strong> 。</p>
</li>
<li><p>在<strong>“KmdfHelloWorld 属性页”</strong>窗口中，转到<strong>“配置属性”&gt;“驱动程序安装”&gt;“部署”</strong>，如下所示。</p>
</li>
<li><p>选中<strong>“部署前删除以前的驱动程序版本”</strong> 。</p>
</li>
<li><p>对于<strong>“目标设备名称”</strong> ，请选择先前配置的用于测试和调试的计算机名，本例中为<code>MyComputer</code></p>
</li>
<li><p>选择<strong>“硬件 ID 驱动程序更新”</strong> ，然后输入驱动程序的硬件 ID。</p>
<ul>
<li><p>本例中，硬件 ID 不标识真实的硬件。 它标识了虚构设备。</p>
</li>
<li><p>该虚拟设备的硬件 ID 可以在驱动程序的信息 (INF) 文件中看到</p>
<img src="/images/configure-windows-driver-development-environment/image-20240306181215750.png" alt="image-20240306181215750" style="zoom:67%;" />
</li>
<li><p>在文件中搜索<code>[Standard.NT$ARCH$]</code>可以看到如下内容，其中红色框框内即为硬件 ID</p>
<img src="/images/configure-windows-driver-development-environment/image-20240306181337978.png" alt="image-20240306181337978" style="zoom:60%;" /></li>
</ul>
</li>
<li><p>在<strong>“生成”</strong>菜单上，选择<strong>“部署解决方案”</strong>。 Visual Studio 会自动将安装和运行驱动程序所需的文件复制到目标计算机。 部署可能需要一两分钟。</p>
</li>
<li><p>切到目标计算机，访问<code>C:\drivertest\drivers</code>文件夹，验证驱动文件是否成功复制。</p>
<img src="/images/configure-windows-driver-development-environment/pic1.png" alt="" style="zoom: 67%;" /></li>
</ol>
<h3 id="Step7：在目标计算机上安装驱动程序"><a href="#Step7：在目标计算机上安装驱动程序" class="headerlink" title="Step7：在目标计算机上安装驱动程序"></a>Step7：在目标计算机上安装驱动程序</h3><ol>
<li><p>在<strong>目标计算机</strong>上找到 <code>DevCon</code> 工具。笔者是在<code>C:\DriverTest</code>文件夹找到的<code>DevCon.exe</code>文件。如果找不到也可以在<strong>主计算机</strong>的 WDK 文件夹<code>C:\Program Files (x86)\Windows Kits\10\Tools\x64\devcon.exe</code> 中找到并复制到<strong>目标计算机</strong></p>
</li>
<li><p>在<strong>目标计算机</strong>上，导航到包含驱动程序文件的文件夹（本例中为：<code>C:\drivertest\drivers</code>），然后运行 DevCon 工具，以安装驱动程序。</p>
<ul>
<li>使用 DevCon 工具安装驱动程序的语法：<code>devcon install &lt;INF file&gt;&lt;hardware ID&gt;</code>。</li>
<li>以<strong>管理员身份</strong>启动终端，输入命令：<code>..\devcon.exe install KMDFHelloWorld.inf root\kmdfhelloworld</code></li>
</ul>
<img src="/images/configure-windows-driver-development-environment/pic2.png" style="zoom:70%;" />
</li>
<li><p>可以在<strong>目标计算机</strong>上使用 <code>driverquery</code> 命令验证 HelloWorld 驱动是否安装成功。</p>
<p><img src="/images/configure-windows-driver-development-environment/pic3.png"></p>
</li>
</ol>
<h3 id="Step8：使用-WinDBG-USB-的模式调试目标计算机"><a href="#Step8：使用-WinDBG-USB-的模式调试目标计算机" class="headerlink" title="Step8：使用 WinDBG + USB 的模式调试目标计算机"></a>Step8：使用 WinDBG + USB 的模式调试目标计算机</h3><h4 id="什么是-WinDBG-？"><a href="#什么是-WinDBG-？" class="headerlink" title="什么是 WinDBG ？"></a>什么是 WinDBG ？</h4><ul>
<li>WinDbg是Microsoft Windows上的<strong>多用途调试器</strong>，可从微软网站上免费下载安装使用。用于调试<strong>用户态下的应用程序、驱动程序</strong>，以及<strong>核心态下的操作系统自身</strong>。</li>
<li>WinDBG 支持以下类型的双机连接模式：<ul>
<li>以太网</li>
<li>USB 2.0 &#x2F; <strong>USB 3.0</strong></li>
<li>串行（也称为零调制解调器）</li>
</ul>
</li>
<li>如果使用 <strong>以太网</strong> 或 <strong>USB</strong> 进行双机调试，对 <strong>目标计算机</strong> 的 网卡型号 或 USB端口 有一定要求。笔者一开始按照微软官方教程搭建环境，一直卡在双机通信这一步，两台机器虽然能够相互 ping 通，但是 WinDBG 始终连接不上。后来才发现是因为 目标计算机 的网卡型号不满足要求，故转战 USB 连接。下面将分别给出针对 网卡型号 和 USB 端口 的检查方式，请读者结合实际情况选择合适的连接方案。</li>
</ul>
<h4 id="如何检查网卡型号？"><a href="#如何检查网卡型号？" class="headerlink" title="如何检查网卡型号？"></a>如何检查网卡型号？</h4><ul>
<li><p>WinDBG 仅对 <strong>目标计算机</strong> 的网卡型号有要求哦，因此后续步骤均在 目标计算机 执行。</p>
</li>
<li><p>以管理员身份启动终端，并切换到 Windows 驱动程序工具包（WDK）目录，默认路径为：<code> C:\Program Files (x86)\Windows Kits\10\Debuggers\x64</code></p>
</li>
<li><p>执行如下命令：<code>.\kdnet.exe</code></p>
</li>
<li><p>若 <strong>网卡型号符合要求</strong> 则输出情况如下：</p>
<img src="/images/configure-windows-driver-development-environment/image-20240307112315521.png" alt="image-20240307112315521" style="zoom:67%;" />
</li>
<li><p>若 <strong>网卡型号不符合要求</strong> 则输出情况如下：</p>
<img src="/images/configure-windows-driver-development-environment/image-20240307112403820.png" alt="image-20240307112403820" style="zoom:67%;" /></li>
</ul>
<h4 id="如何检查USB端口？"><a href="#如何检查USB端口？" class="headerlink" title="如何检查USB端口？"></a>如何检查USB端口？</h4><ol>
<li><p>在<strong>目标计算机</strong>上，启动 <em><strong>UsbView</strong></em> 工具。 UsbView 工具包含在适用于 Windows 的调试工具中。</p>
<img src="/images/configure-windows-driver-development-environment/image-20240307120009804.png" alt="image-20240307120009804" style="zoom: 50%;" />
</li>
<li><p>在 UsbView 中，展开 xHCI 主机控制器的节点。 查找主机控制器上的端口支持调试的指示。如果 <code>Is Port Debug Capable</code> 字段为 <code>yes</code> 则表明该端口支持 WinDBG。</p>
<img src="/images/configure-windows-driver-development-environment/image-20240307120111745.png" alt="image-20240307120111745" style="zoom:50%;" />
</li>
<li><p>记下要用于调试的 xHCI 控制器的总线、设备和函数号。 UsbView 会显示这些数字。</p>
</li>
</ol>
<img src="/images/configure-windows-driver-development-environment/image-20240307120812626.png" alt="image-20240307120812626" style="zoom:50%;" />

<ol start="4">
<li>找到支持调试的 xHCI 控制器后，下一步是查找与 xHCI 控制器上的端口关联的物理 USB 连接器。 请将任何 USB 3.0 设备插入目标计算机上的任何 USB 连接器<strong>（说白了就是试，把每个口都插一插，然后刷新 UsbView，看看连接信息是否更新，如果更新了就找到了）</strong>。 刷新 UsbView 以查看设备所在的位置。 如果 UsbView 显示设备连接到所选的 xHCI 主机控制器，则表明你找到了可用于 USB 3.0 调试的物理 USB 连接器。</li>
</ol>
<h4 id="如何使用-USB-建立双机连接？"><a href="#如何使用-USB-建立双机连接？" class="headerlink" title="如何使用 USB 建立双机连接？"></a>如何使用 USB 建立双机连接？</h4><ol>
<li><p>在 <strong>”如何检查USB端口“”</strong> 一节我们已经找到了目标计算机上可用的 USB 接口，因此我们要先建立物理链路上的连接，即<strong>用数据线连接两台机器</strong>。</p>
</li>
<li><p>在<strong>目标计算机</strong>上，以<strong>管理员身份</strong>打开命令提示符窗口，然后输入以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /debug on</span><br><span class="line">bcdedit /dbgsettings usb targetname:&lt;TargetName&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><em>TargetName</em> 是为目标计算机创建的名称。 请注意， <em>TargetName</em> 不一定是目标计算机的官方名称;只要满足以下限制，它就可以是创建的任何字符串：<ul>
<li>字符串不得在 <em>TargetName</em> 中的任何位置包含“debug”，大小写或大写的任意组合。 例如，如果在 targetname 中的任何位置使用“DeBuG”或“DEBUG”，则调试无法正常工作。</li>
<li>字符串中唯一的字符是连字符 ( ) 、下划线 (_) 、数字 0 到 9，以及字母 A 到 Z (大写或小写) 。</li>
<li>字符串的最大长度为 24 个字符。</li>
</ul>
</li>
</ul>
</li>
<li><p>继续执行以下命令：<code>bcdedit /set &quot;&#123;dbgsettings&#125;&quot; busparams &lt;b.d.f&gt;</code></p>
<ul>
<li>其中，b，d，f 是 USB 主控制器的总线、设备和功能编号。均采用 10 进制。</li>
<li>在 <strong>”如何检查USB端口“</strong> 一节我们记录过这个 PCIe 域地址哦，忘了的家人可以再去瞅一眼。</li>
</ul>
</li>
<li><p>在<strong>“设备管理器”</strong>中，导航到 <strong>xHCI 主控制器</strong>的节点。 右键单击<strong>“节点”</strong>，然后选择<strong>“属性”。</strong> 如果有 <strong>“电源管理</strong> ”选项卡，请打开该选项卡，然后清除 <strong>“允许计算机关闭此设备以节省电源</strong> ”复选框。</p>
</li>
<li><p>重新启动<strong>目标计算机</strong>。</p>
</li>
<li><p>在 <strong>主计算机</strong> 上下载并安装最新版 WinDBG，最新版的 GUI 界面比老版好的不要太多。<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/debugger/">下载链接</a></p>
</li>
<li><p>以 <strong>管理员身份</strong> 运行 WinDBG，选择 <strong>file -&gt; Attach to kernel -&gt; USB -&gt; 输入本节第2步起的 targetname -&gt; 选择 Break on connection -&gt; OK</strong></p>
<img src="/images/configure-windows-driver-development-environment/image-20240307162231068.png" alt="image-20240307162231068" style="zoom:50%;" />
</li>
<li><p>随后会进入如下界面，显示 <strong>“Waiting to reconnect”</strong></p>
<img src="/images/configure-windows-driver-development-environment/image-20240307162605583.png" alt="image-20240307162605583" style="zoom:50%;" />
</li>
<li><p>重新启动 <strong>目标计算机</strong>。由于我们之前勾选了 ”连接时中断“，因此在 目标计算机 再次启动加载 Windows 操作系统时会停住。主计算机 WinDBG 窗口显示如下内容。</p>
<p><strong>至此，WinDBG 成功连接到目标计算机，并让其中断在初始化阶段，我们可以在任何想要的地方打断点！</strong></p>
<img src="/images/configure-windows-driver-development-environment/image-20240307172708095.png" alt="image-20240307172708095" style="zoom:70%;" />
</li>
<li><p>使用 <code>bu 驱动名!函数名</code>命令在 HelloWorld 驱动初始化函数处打断点，使用 <code>bl</code> 命令验证打断点成功（在bd&gt;后面输入命令）</p>
</li>
</ol>
<p>   <img src="/images/configure-windows-driver-development-environment/image-20240307172822833.png" alt="image-20240307172822833"></p>
<ol start="11">
<li><p>使用 <strong><code>g</code></strong> 命令启动目标计算机上的 Windows 操作系统，等待几秒后，它会停止在断电处，WinDBG 显示如下图！<strong>大功告成！</strong></p>
<p><img src="/images/configure-windows-driver-development-environment/image-20240307172957286.png" alt="image-20240307172957286"></p>
</li>
</ol>
<p><strong>debug</strong>：</p>
<ul>
<li><p>如果出现 <code>Failed to USB device driver inf. The debugger must be copy run elevated first for the use of this transport. Error 0x5</code>报错，如下图所示，是因为<strong>打开 WinDBG 时没有使用管理员模式！</strong></p>
<p><img src="/images/configure-windows-driver-development-environment/image-20240307162522591.png" alt="image-20240307162522591"></p>
</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2024/03/02/Von-Neumann-architecture/" rel="next" title="浅谈冯诺依曼结构">
                <i class="fa fa-chevron-left"></i> 浅谈冯诺依曼结构
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="PIPI" />
            
              <p class="site-author-name" itemprop="name">PIPI</p>
              <p class="site-description motion-element" itemprop="description">记录一些重要的技术点，方便自己查阅，也希望能够帮助到大家。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives%7C%7C%20archive">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">概述：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="nav-number">2.</span> <span class="nav-text">核心步骤：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step1%EF%BC%9A%E5%9C%A8%E4%B8%BB%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%8A%E5%AE%89%E8%A3%85-visual-studio-2022-Windows-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%B7%A5%E5%85%B7%E5%8C%85"><span class="nav-number">3.</span> <span class="nav-text">Step1：在主计算机上安装 visual studio 2022 + Windows 驱动程序工具包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step2%EF%BC%9A%E7%BC%96%E5%86%99-Hello-World-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F"><span class="nav-number">4.</span> <span class="nav-text">Step2：编写 Hello World 驱动程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step3%EF%BC%9A%E7%94%9F%E6%88%90-Hello-World-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F"><span class="nav-number">5.</span> <span class="nav-text">Step3：生成 Hello World 驱动程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step4%EF%BC%9A%E6%9C%AC%E5%9C%B0%E6%B5%8B%E8%AF%95-Hello-World-%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="nav-number">6.</span> <span class="nav-text">Step4：本地测试 Hello World 驱动程序 （可选）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step5%EF%BC%9A%E9%A2%84%E9%85%8D%E7%9B%AE%E6%A0%87%E8%AE%A1%E7%AE%97%E6%9C%BA"><span class="nav-number">7.</span> <span class="nav-text">Step5：预配目标计算机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step6%EF%BC%9A%E5%9C%A8%E7%9B%AE%E6%A0%87%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%8A%E9%83%A8%E7%BD%B2%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-number">8.</span> <span class="nav-text">Step6：在目标计算机上部署解决方案</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step7%EF%BC%9A%E5%9C%A8%E7%9B%AE%E6%A0%87%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%8A%E5%AE%89%E8%A3%85%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F"><span class="nav-number">9.</span> <span class="nav-text">Step7：在目标计算机上安装驱动程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step8%EF%BC%9A%E4%BD%BF%E7%94%A8-WinDBG-USB-%E7%9A%84%E6%A8%A1%E5%BC%8F%E8%B0%83%E8%AF%95%E7%9B%AE%E6%A0%87%E8%AE%A1%E7%AE%97%E6%9C%BA"><span class="nav-number">10.</span> <span class="nav-text">Step8：使用 WinDBG + USB 的模式调试目标计算机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-WinDBG-%EF%BC%9F"><span class="nav-number">10.1.</span> <span class="nav-text">什么是 WinDBG ？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E6%A3%80%E6%9F%A5%E7%BD%91%E5%8D%A1%E5%9E%8B%E5%8F%B7%EF%BC%9F"><span class="nav-number">10.2.</span> <span class="nav-text">如何检查网卡型号？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E6%A3%80%E6%9F%A5USB%E7%AB%AF%E5%8F%A3%EF%BC%9F"><span class="nav-number">10.3.</span> <span class="nav-text">如何检查USB端口？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-USB-%E5%BB%BA%E7%AB%8B%E5%8F%8C%E6%9C%BA%E8%BF%9E%E6%8E%A5%EF%BC%9F"><span class="nav-number">10.4.</span> <span class="nav-text">如何使用 USB 建立双机连接？</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">PIPI</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>





    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
